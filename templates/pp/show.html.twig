{% extends 'base.html.twig' %}


{% block meta %}

    <meta name="author" content="{{ presentation.creator.persorg.name }}">
    <meta name="keywords" content="{{ presentation.keywords }}">
    <meta name="date" content="{{ presentation.createdAt | date}}">
    
{% endblock %}

{% block stylesheet %}{% endblock %}
    

{% block title %}{{ presentation.goal | capitalize}}{% endblock %}

{% block sidebar %} 

    {% if is_granted('edit', presentation) %}
    
        {% include 'partials/sidebar.html.twig' %} 

    {% endif %}
    
{% endblock %}


{% block body %}


<style>

    /* Whole Presentation Container */

    .pp-whole-container {

        background-color :  #eff4ff;
 
     }

     /* Each Structure Container */

    .pp-struct-container {

        background-color : aliceblue;

        padding-left: 20px;

        padding-top: 18px;

        margin-bottom: 35px;

        border-radius: 0px;

        -webkit-box-shadow: -4px 4px 9px 0px rgba(0,0,0,0.75) !important;
        -moz-box-shadow: -4px 4px 9px 0px rgba(0,0,0,0.75) !important;
        box-shadow: -1px 1px 6px 0px #e6e4ff !important;
    
    }

    


    /* Each Structure Title Container (contains title + edit button) */
  
    .pp-struct-title-container{

        margin-bottom: 38px;

        //display: flex;
        //align-items:center;

    }

    /* Each Structure Title */
  
    .pp-struct-title{

        display:inline-block;
        color : navy;
        font-family : Verdana, Geneva, Tahoma, sans-serif; 
        margin-right:10px;

    }

    /* Each Structure Icon */
  
    .pp-struct-icon{

        margin-right : 7px;

    }


    
    @media screen and (max-width: 580px) {

      
        .pp-struct-container {
    
            padding-left: 10px;
            padding-right: 10px;
            padding-top: 4px;

            margin-bottom: 15px;

            font-size: 15px !important;
            font-family: Verdana, Geneva, Tahoma, sans-serif;

        
        }

        .pp-struct-title-container{

            margin-bottom: 18px;

            //margin-left:10px;
    
        }

        .pp-struct-title{

            color : navy;
            font-family : Verdana, Geneva, Tahoma, sans-serif;

            font-size: 20px;
    
        }

    }

</style>


    <!-- Project Presentation Display Template -->

    <div class="pp-whole-container col-md-12 col-xl-10 mt-md-5 mb-md-4 px-md-4 pt-1 pt-md-3
    
        {# we center the presentation display when we are in consultation mode (in contrast, when in edit mode view, the presentation is not centered) #}


        {% if not is_granted('edit', presentation) %}
    
            container 

        {% endif %}
    
    ">


        <div class="row pt-2 px-md-2">


            <div class="col-md-12 mb-3 pb-3" style="border-radius:4px !important;">

                <!-- Upper Box (Contains Project Logo; Title; Goal; Keywords) -->
                {% include 'pp/partials/_upper_box.html.twig' %}

                <!-- Project Images & Videos (Displayed in a Slideshow) -->
                {% include 'pp/partials/_slideshow.html.twig' %}
                
                <!-- Project Text Description -->
                {% include 'pp/partials/_textDescription.html.twig' %}
                
                <!-- Project Follow Button -->
                {% include 'pp/partials/_follow_button.html.twig' %}
                
                <!-- Project Supplementary Informations (aka Technical Data)-->
                {% include 'pp/partials/_technicalData.html.twig' %}
                
                <!-- Project Documents -->
                {% include 'pp/partials/_documents.html.twig' %}
                
                <!-- Project Dates & Events -->
                {% include 'pp/partials/_datesEvents.html.twig' %}
                
                <!-- Project Questions & Answers -->
                {% include 'pp/partials/_questionAnswer.html.twig' %}

                <!-- Project Needs -->
                {% include 'pp/partials/_needs.html.twig' %}

                <!-- Project Websites -->
                {% include 'pp/partials/_websites.html.twig' %}
                
                <!-- Project Geographic Domains -->
                {% include 'pp/partials/_geoDomains.html.twig' %}

                <!-- Project Owners -->
                {% include 'pp/partials/_owners.html.twig' %}

                <!-- Project Team -->
                {% include 'pp/partials/_team.html.twig' %}


                <!-- Project External Contributors -->
                {% include 'pp/partials/_externalContributors.html.twig' %}

                <!-- Project News -->
                {% include 'pp/partials/_news.html.twig' %}

                <!-- Project Contact Us Cards & Private Message Button -->
                {% include 'pp/partials/_contactUs.html.twig' %}

                <!-- Users Comments -->
                {% include 'pp/partials/_comments.html.twig' %}

                <!-- Other Buttons -->

                <div class="mt-5 mb-3">

                    <!-- Display Some Metadatas -->
                    {% include 'pp/partials/_metadataDisplay.html.twig' %}

                    <!-- some buttons (example : report abuse; save as pdf; ...) -->

                    <a href="{{ path('report_new', {'context': presentation.id ~ ' ' ~  presentation.slug}) }}">

                        <button type="button" class="btn btn-light mr-2 mb-2 ">Signaler un abus</button>
                        
                    </a>


                    <a href="{{ path('edit_presentation_request', {'slug': presentation.slug}) }}">
                        <button type="button" class="btn btn-light mb-2">Pr√©senter ce projet</button>

                    </a>
                        

                    <!-- Back to top button -->

                    <button onclick="topFunction()" id="backTopButton" class="btn btn-light mb-2" title="Retour en Haut">‚Üë Haut de Page</button> 

                </div>

                {# Switch Between Edition Mode and Consultation Mode #}

                {% if is_granted('edit', presentation) %}

                    <button id="pp-switch-edit-consult-mode" class="edition-mode" title="Switch between edition and consultation">üëÅ</button>

                {% endif %}
               

                <!-- Project Provider Caps -->
                {# {% include 'pp/partials/_projectPresenterArea.html.twig' %} #}



            </div>
        
        </div>


    <style>

        #pp-switch-edit-consult-mode {
            position: fixed; /* Fixed/sticky position */
            top: 420px; /* Place the button at the bottom of the page */
            right: 30px; /* Place the button 30px from the right */
            z-index: 99; /* Make sure it does not overlap */
            border: none; /* Remove borders */
            outline: none; /* Remove outline */
            background-color: #d6f0ca; /* Set a background color #b2f295 */
            color: rgb(0, 0, 0); /* Text color */
            cursor: pointer; /* Add a mouse pointer on hover */
            padding: 15px; /* Some padding */
            border-radius: 50%; /* Rounded corners */
            font-size: 18px; /* Increase font size */
          }

        </style>


    </div>

{% endblock %}


{# Javascripts for Specific Project Structures Behaviours#}

{% block javascripts %}

    <!-- Back to Top Button -->

    {% include 'pp/js_show/_back_top_button.html.twig' %}

    <!-- Project Comments Management -->

    <script>
        
        $(document).ready(function(){
            
            {% if is_granted('edit', presentation) %}
                    
                $( "#pp-switch-edit-consult-mode" ).click(function() {
                    
                    if($(this).hasClass("edition-mode")){

                        // toggling switch button class

                        $(this).removeClass("edition-mode");
                        $(this).addClass("consultation-mode");
                        $(this).html("‚úé");

                        //hiding pp elements related to edition
                        $(".pp-edition-mode").hide();

                        //manage sidebar disappearing
                        $(".pp-whole-container").addClass("container");

                    }

                    else{
                        // toggling switch button class

                        $(this).removeClass("consultation-mode");
                        $(this).addClass("edition-mode");
                        $(this).html("üëÅ");
                        

                        $(".pp-edition-mode").show();
                        //manage sidebar appearing
                        $(".pp-whole-container").removeClass("container");

                    }
                
                });


            {% endif %}



            // If reply to a comment form has errors, we display them to user (so we trigger Modal display) 

            {% if not replyForm.vars.valid %}
        
                 $('#replyCommentModal').modal('show');

            {% endif %}

            // When user wants to reply to a comment, we catch the parent comment id, and store it in the reply to comment form hidden field

            $( ".js-reply-comment-button" ).click(function() {
                
                var parentCommentId = $(this).data("id");

                $("#reply_comment_parentCommentId").val(parentCommentId);
              
            });

            //when user reply to a comment, we give focus to textarea

            $('#replyCommentModal').on('shown.bs.modal', function () {
                
                $('#reply_comment_content').focus();
                
            }) 
            
            //we hide the form honey pot
            
            $('.onpt').hide();
            
            
        });

    </script>


    <!-- Project Needs Section : ajax call when user wants need details -->

    {% if presentation.needs %}

        {% include 'pp/js_show/_needs.html.twig' %}
        
    {% endif %}

    <!-- Project News Section : ajax call when user wants news details -->

    {% if presentation.news %}

        {% include 'pp/js_show/_news.html.twig' %}
        
    {% endif %}


    <!-- ProjectTeammates & owners Sections : caroussel display -->

    {% if presentation.teammates | length > 0 or presentation.owners | length > 0 %}

        <script type="text/javascript" src="/js/slick.min.js"></script>

        <!--Styles for Slick Slideshow -->

        <link rel="stylesheet" type="text/css" href="/css/slick.css"/>

        <script>
            
            $(document).ready(function(){

                // !!! Seems that only one instance is working

                $('.teammatesSlideshow, .ownersSlideshow').slick({

                    slidesToShow: 3,
                    infinite:false,
                    variableWidth: true,

           
                    
                });

                jQuery(window).on('resize', function() {
                    var viewportWidth = jQuery(window).width();
                
                    if (viewportWidth < 481) {
                        $('.test').slick('unslick');
                    } else {
                        // Do some thing
                    }
                });



            });

        </script>
        
    {% endif %}





{% endblock %}
