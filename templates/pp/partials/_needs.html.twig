<!-- WARNING Javascript ajax management is done in pp/show.html.twig due to jQuery.js loading priorities -->

<!-- Project Desired Ressources (= needs) Display -->

{% if presentation.needs | length > 0 %}

    <!-- Structure Container -->

    <div class="pp-struct-container pp-struct-needs">

        <!-- Title Container -->

        <div class="pp-struct-title-container">

            <h3 class="pp-struct-title d-inline mr-2">
                
                {% if presentation.needs | length == 1 %}
                    Participer - 1 besoin

                {% else %}
                    
                    Participer - {{presentation.needs | length}} besoins

                {% endif %}
                
            </h3>

                    
            <!-- Manage Project Needs Button -->

            {% if app.user and app.user == presentation.creator %}
                <a href="{{ path('need_index', {'slug': presentation.slug}) }}">

                    <button class="btn btn-light sharp font-weight-bold mb-2 d-inline fs-15">Gérer les besoins</button>
                    
                </a>
            {% endif %}

        </div>

        

        <!-- Some Style -->

        <style>

            #needsDisplayTable td:hover, #needsDisplayTable .pp-struct-container a:hover {
                        
                background-color : gainsboro;

            }

            #needsDisplayTable tbody tr:first-child {
                        
                /* margin-top:0px !important;
                padding-top:0px !important;

                background-color: brown; */

            }


            @media screen and (max-width: 580px) {

                #needsDisplayTable td {

                    font-size: 17px;
                    font-weight: normal;

                    padding-top: 9px;
                    padding-bottom: 9px;

                }


            }

        </style>
        
        
        
        <!-- Project Needs Display List -->
    
        <div class="container-fluid table-responsive pl-0 pl-md-3">
            
            <table id="needsDisplayTable" class="table mb-1 mb-md-3 table-hover table-borderless">
                
                <tbody>

                    {% for need in presentation.needs %}

                        <!-- Needs Titles Display (in a Table) -->

                                    
                        <!-- Is it a Paid Service ? We prepare the Answer. -->

                        {% set isPaid = '' %}

                        {% if need.paidService %}
                        
                            {% if need.paidService == 'yes' %}
                                {% set isPaid = "Payé" %}

                            {% elseif need.paidService == 'no' %}
                                {% set isPaid = "Non Payé" %}

                            {% elseif need.paidService == 'maybe' %}
                                {% set isPaid = "Peut-être Payé" %}

                            {% else %}

                                {% set isPaid = "" %}
                            
                            {% endif %}

                        {% endif %}

                        <tr id="{{ need.id }}" data-need-title = "{{ need.title }}" data-need-date = "{{need.createdAt |date('d-m-Y')}}" data-need-isPaid = "{{ isPaid }}" class="cursor-pointer h5 font-weight-bold">

                            <td>
                
                                <a data-toggle="modal" data-target="#displayNeedDescriptionModal" class="text-body text-decoration-none">

                                    {# Blue Arrow bullet point #}
                                    
                                    <span class="arrowCar blueArrow">► </span>

                                    {# Need Title #}
                                    
                                    {{ need.title | capitalize}}

                                </a>

                            </td>

                        </tr>

                    {% endfor %}


                </tbody>
        
            </table>

        </div>

                
        <!-- Display Need Details (in a Modal Box) -->

        <div class="modal fade" id="displayNeedDescriptionModal" tabindex="-1" role="dialog" aria-labelledby="displayNeedDescriptionModalLabel" aria-hidden="true">

            <div class="modal-dialog" role="document">

                <div class="modal-content">

                    <!-- Need Title Display -->

                    <div class="modal-header">
                        
                        <h5 id="titleNeedModal" class="modal-title font-weight-bold" id="displayNeedDescriptionModalLabel"></h5>

                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">

                            <span aria-hidden="true">&times;</span>

                        </button>

                    </div>

                    <div class="modal-body fs-15" >

                        <!-- Date Display -->

                        <div class = "mb-2" >

                            <span class="">
                                Publié le 
                            </span>

                            <span id="dateNeedModal"></span>

                        </div>

                        <!-- + Info Display -->

                        <div class = "mb-3" >

                            <span class="font-weight-bold">
                                Info + : 
                            </span>
                            
                            <span id="isPaidNeedModal" class="h6 p-1 font-weight-bold rounded bg-primary text-white"></span>

                        </div>

                        <!-- Need Description Display -->

                        <div id="descriptionNeedModal" style="white-space:pre-wrap;">

                        </div>

                    </div>


                    <!-- Action Buttons -->

                    <div class="modal-footer">

                        <!-- Back Button -->

                        <button type="button" class="btn btn-info sharp font-weight-bold" data-dismiss="modal">Retour</button>

                        <!-- Send a Private Message Button -->

                        <a href="{{path('contact_message_new', {'slug':presentation.slug})}}">
                            <button type="button" class="btn btn-primary sharp font-weight-bold">Entrer en contact</button>
                        </a>

                    </div>

                </div>

            </div>

        </div>

    </div>


{% endif %}

