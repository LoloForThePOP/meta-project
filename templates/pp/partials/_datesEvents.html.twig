
<!-- Project Dates & Events Display -->

{% if presentation.events | length > 0 %}

    <!-- Structure Container -->

    <div class="pp-struct-container pb-1 pb-md-3">

        <!-- Title Container with Edit Button -->

        <div class="mb-3">

            <!-- Structure Title -->

            <h3 class="pp-struct-title d-inline mr-2 mb-2">Événements et dates</h3>
    
            <!-- Edit Dates & Events (Button) -->
    
            {% if app.user and app.user == presentation.creator %}
                <a href="{{ path('manage_events', {'slug': presentation.slug}) }}">
    
                    <button class="btn btn-light sharp font-weight-bold mb-2 d-inline fs-15">Gérer les événements</button>
                    
                </a>
            {% endif %}

        </div>

        <!-- Project Dates & Events Display -->

        <div class="container mt-4 px-0">
                  
          <!-- Styles for the Timeline -->

          <style>
              
              .timeline {
                
                  list-style-type: none;
                  display: flex;
                  align-items: center;
                  justify-content: center;

                  overflow-x: auto;
                  overflow-y: hidden;
              

                  padding-left:15px;
                    
                }
                
                .li {
                  
                  transition: all 200ms ease-in;

                  cursor:pointer;

                  border-radius: 5%;
                  
                }
                
                .li:hover {

                  background-color: rgb(255, 255, 202);
                  
                }
                
                .timestamp {
                  margin-bottom: 12px;
                  padding: 0px 8px;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  text-align: center;
                  font-weight: 100;

                  width:172px;

                  border: none;

                  min-height: 80px;;
                  
                }

                /* First Dot (just a decoration) */

                .timeline li:first-child{
                  margin-top:45px;
                  border-radius: 10px;
                  border: 10px solid #31708F;
                }

                /* Ending Arrow (just a decoration) */

                .timeline li:last-child{
                  margin-top:45px;
                  border: 10px solid transparent;
                  border-right: 0;
                  border-left: 20px solid  #31708F;
                  border-radius: 3px;
                }


                .timestamp .author {

                  color:rgb(19, 124, 19);

                  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

                  font-size: 1.15em;
                  font-weight: bold;
                  

                }

                .timestamp .date {

                  font-size:1em;
                  font-weight: 600;

                }

                
                .status {
                  padding-top: 15px;
                  display: flex;
                  justify-content: center;
                  border-top: 2px solid #D6DCE0;
                  position: relative;
                  transition: all 200ms ease-in;

                  border: none;

                  min-height: 50px;;
                
                }


                .status h4 {
                  font-weight: 600;
                  min-height:40px;
                  
                }

                .status:before {
                  content: "";
                  width: 25px;
                  height: 25px;
                  background-color: white;
                  border-radius: 25px;
                  border: 3px solid rgb(184, 14, 14);
                  position: absolute;
                  top: -15px;
                  left: 42%;
                  transition: all 200ms ease-in;
                  
                }
                
                .li.complete .status {
                  border-top: 4px solid darkslategray;

                
                }

                .li.complete .status:before {
                /* background-color: #66DC71; */
                  border:3px solid navy;
                  transition: all 200ms ease-in;
                  
                }

                .li.complete .status h4 {
                  color:black;
                }

              .timeline::after {
                
                  border: 10px solid transparent !important;
                  border-right: 0;
                  border-left: 20px solid red !important;
                  border-radius: 3px;
              }


              @media screen and (max-width: 580px) {

                  .timeline {
                    
                      overflow-x: auto;
                      overflow-y: hidden;
                        
                  }

                .timestamp .author {

                  font-size:0.9em;
                  font-weight: 600;
                  

                }

                .timestamp .date {

                  font-size:0.9em;
                  font-weight: 600;

                }


              }



              
              
              

                /*  
                
                @media (min-device-width: 320px) and (max-device-width: 700px) {
                  .timeline {
                    list-style-type: none;
                    display: block;
                  }
                
                  .li {
                    transition: all 200ms ease-in;
                    display: flex;
                    width: inherit;
                  }
                
                  .timestamp {
                    width: 100px;
                  }
                
                  .status:before {
                    left: -8%;
                    top: 30%;
                    transition: all 200ms ease-in;
                  }
                }

                */
                
          </style>

          <!-- Project Events Display (in a Timeline) -->

          <ul class="timeline" id="timeline">

            <!-- First Timeline Dot at the beginning (just a decoration) -->

            <li></li>

            {% for event in presentation.events %}

              <!-- Does this event has More Info to Show in a Modal ? (when too many informations to display) -->

              {% set moreDisplay = false %}

              {% if event.endDate | length > 0 %}

                {% set moreDisplay = true %}
                    
              {% endif %}

          {#   {% if loop.index == 6 %}

                  <li class="li" style="border : 2px solid navy; margin-top:35px; padding:10px 5px;"> 
                      
                      <div class="text-center">

                          Afficher Tout

                      </div>
                      
                  </li>

                  <div class="newLine">
              
              {% endif %}#}

              <!-- a Timeline Chunk -->

              <li class="li complete" data-toggle="modal" data-target="#eventDisplayModal{{ loop.index }}">

                  <!-- Informations Above the Timeline Chunk -->

                  <div class="timestamp d-flex justify-content-center">

                      <span class="author">{{ event.title | length < 25 ? event.title : event.title |slice(0, 25) ~ '...' }}</span>

                      <span class="date">{{event.beginDate  | date("d/m/Y") }}<span>

                  </div>

                  <!-- Informations Bellow the Timeline Chunk -->
                  
                  <div class="status cursor-pointer">

                      <!-- Potential "Show More Informations" Button (trigger a modal)-->

                      {% if moreDisplay %}

                          <a data-toggle="modal" data-target="#eventDisplayModal{{ loop.index }}" class="btn btn-sm btn-light font-weight-bold" style="margin-top:5px; padding: 0px 4px;"> Afficher +</a>
                      
                      {% endif %}
                      
                  </div>

            </li>

            
            {#  {% if loop.last %}
                  
                  </div>

              {% endif %} #}

          {% if moreDisplay == true %}
          
              <!-- Display Events Details (in a modal) -->

              <div class="modal fade" id="eventDisplayModal{{ loop.index }}" tabindex="-1" role="dialog" aria-labelledby="eventDisplayLabel{{ loop.index }}" aria-hidden="true">
                          
              <div class="modal-dialog" role="">

                  <div class="modal-content">

                  <!-- Modal Header -->

                  <div class="modal-header">

                      <!-- Event Complete Title -->

                      <div class="row pl-4"> 

                          <div class="h5 font-weight-bold pr-md-3" >

                              {{ event.title }}

                          </div>
                      
                      </div>


                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">

                          <span aria-hidden="true">&times;</span>

                      </button>

                  </div>

                  <!-- Modal Body -->

                  <div class="modal-body px-4">

                      <div class="container">

                          <!-- Event Dates -->

                          <div class="row mb-3"> 
                              
                              <b> 

                              {% if event.beginDate %}

                                  Le {{event.beginDate | date("d/m/Y") }}

                                  {% if event.beginTime %}

                                      à {{event.beginTime | date("H:i")}}

                                  {% endif %}

                              {% endif %}


                              {% if event.endDate %}

                                  <br>

                                  Termine le {{event.endDate | date("d/m/Y") }}  

                                  {% if event.endTime %}

                                      à {{event.endTime | date("H:i")}}

                                  {% endif %}

                              {% endif %}

                              </b>


                          </div>


                          <!-- Event Long Description -->

                              <div class="row fs-15 mb-3"> 
                                  
                                  {% if event.description %}

                                      {{event.description}}

                                  {% else %}
                                      
                                      Pas de description détaillée.
                                  
                                  {% endif %}

                              </div>


                          <!-- "Created At" & "Last Updated At" Display -->

                          <div class="row">

                              <small>

                                  <!-- Last Updated at -->

                                  {% if event.updatedAt %}
                                  
                                      Modifié le {{ event.updatedAt | date("Y-m-d") }} à 
                                      {{ event.updatedAt | date("H:i") }}

                                      <br>
                                  
                                  {% endif %}

                                  <!-- Created At -->

                                  Créé le {{ event.createdAt | date("Y-m-d") }} à {{ event.createdAt | date("H:i") }}

                              </small>

                          </div>

                          



                        

                  
                      
                


                        

                      <!-- End of Modal Body Container -->

                      </div>

                  <!-- End of Modal Body -->

                  </div>

                  <!-- Modal footer -->

                  <div class="modal-footer">

                      <button type="button" class="btn btn-info sharp" data-dismiss="modal">Retour</button>

                  </div>

                  </div>

              </div>

              </div>  
          
          {% endif %}


          {% endfor %}

            <!-- Ending Timeline Arrow (just a decoration) -->

            <li></li>

          </ul>

        </div>

    </div>

{% endif %}